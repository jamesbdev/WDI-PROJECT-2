"use strict";var App=App||{},google=google;App.mapSetup=function(){App.$main.html('<div id="map-container"></div>');var e=document.getElementById("map-container"),t={zoom:13,center:new google.maps.LatLng(51.506178,(-.088369)),mapTypeId:google.maps.MapTypeId.ROADMAP,styles:styledMapType};this.map=new google.maps.Map(e,t),this.getRestaurants()},App.getRestaurants=function(){$.get("http://localhost:3000/api/restaurants").done(this.loopThroughRestaurants)},App.loopThroughRestaurants=function(e){$.each(e,function(e,t){App.addMarkerForRestaurant(t)})};var markerImage="../images/marker1.png";App.addMarkerForRestaurant=function(e){var t=new google.maps.LatLng(e.lat,e.lng),i=new google.maps.Marker({position:t,map:this.map,icon:markerImage,animation:google.maps.Animation.DROP});this.addInfoWindowForRestaurant(e,i)};var styledMapType=[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"administrative.locality",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"administrative.land_parcel",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"landscape",elementType:"geometry",stylers:[{visibility:"simplified"},{saturation:"-28"},{lightness:"-7"},{gamma:"1.90"},{weight:"1.98"}]},{featureType:"landscape",elementType:"geometry.stroke",stylers:[{lightness:"-13"}]},{featureType:"landscape",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",elementType:"labels.text",stylers:[{hue:"#ff0000"},{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"on"},{weight:"4.93"}]},{featureType:"poi",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"},{hue:"#ff0000"},{saturation:"-41"},{gamma:"2.64"},{weight:"1.42"}]},{featureType:"poi",elementType:"labels.text",stylers:[{visibility:"simplified"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{visibility:"simplified"},{saturation:"-20"},{lightness:"-44"},{weight:"2.39"},{invert_lightness:!0}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{visibility:"simplified"}]},{featureType:"poi.attraction",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.government",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"all",stylers:[{visibility:"on"},{lightness:"-16"}]},{featureType:"poi.park",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.school",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:"-25"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"},{lightness:"-30"}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"},{lightness:"-62"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"water",elementType:"all",stylers:[{color:"#8ac9cd"},{visibility:"on"},{saturation:"-33"},{lightness:"13"},{gamma:"0.84"},{weight:"1.98"}]}];App.addInfoWindowForRestaurant=function(e,t){var i=this;google.maps.event.addListener(t,"click",function(){"undefined"!=typeof i.infoWindow&&i.infoWindow.close(),i.infoWindow=new google.maps.InfoWindow({content:'\n      <div class="info-window">\n        <img src='+e.image+">\n        <p>"+e.name+"</p>\n      </div>\n      "}),i.infoWindow.open(i.map,t)})},App.register=function(e){e.preventDefault(),this.$main.html('\n  <h2>Register</h2>\n  <form method="post" action="/register">\n    <div class="form-group">\n      <input class="form-control" type="text" name="user[username]" placeholder="Username">\n    </div>\n    <div class="form-group">\n      <input class="form-control" type="email" name="user[email]" placeholder="Email">\n    </div>\n    <div class="form-group">\n      <input class="form-control" type="password" name="user[password]" placeholder="Password">\n    </div>\n    <div class="form-group">\n      <input class="form-control" type="password" name="user[passwordConfirmation]" placeholder="Password Confirmation">\n    </div>\n    <input class="btn btn-primary" type="submit" value="Register">\n  </form>\n  ')},App.login=function(e){e.preventDefault(),this.$main.html('\n    <h2>Login</h2>\n    <form method="post" action="/login">\n      <div class="form-group">\n        <input class="form-control" type="email" name="email" placeholder="Email">\n      </div>\n      <div class="form-group">\n        <input class="form-control" type="password" name="password" placeholder="Password">\n      </div>\n      <input class="btn btn-primary" type="submit" value="Login">\n    </form>\n  ')},App.handleForm=function(e){e.preventDefault();var t=""+App.apiUrl+$(this).attr("action"),i=$(this).attr("method"),a=$(this).serialize();$.ajax({url:t,method:i,data:a}).done(function(e){e.token&&App.mapSetup()}).fail(function(e){console.log(e)})},App.init=function(){this.apiUrl="http://localhost:3000/api",this.$main=$("main"),$(".register").on("click",this.register.bind(this)),$(".login").on("click",this.login.bind(this)),this.$main.on("submit","form",this.handleForm),this.mapSetup()},$(App.init.bind(App));