"use strict";var App=App||{},google=google;App.mapSetup=function(){App.$main.html('<div id="map-container"></div>');var n=document.getElementById("map-container"),o={zoom:13,center:new google.maps.LatLng(51.506178,(-.088369)),mapTypeId:google.maps.MapTypeId.ROADMAP};this.map=new google.maps.Map(n,o),this.getRestaurants()},App.getRestaurants=function(){$.get("http://localhost:3000/api/restaurants").done(this.loopThroughRestaurants)},App.loopThroughRestaurants=function(n){$.each(n,function(n,o){App.addMarkerForRestaurant(o)})},App.addMarkerForRestaurant=function(n){var o=new google.maps.LatLng(n.lat,n.lng),t=new google.maps.Marker({position:o,map:this.map});this.addInfoWindowForRestaurant(n,t)},App.addInfoWindowForRestaurant=function(n,o){var t=this;google.maps.event.addListener(o,"click",function(){"undefined"!=typeof t.infoWindow&&t.infoWindow.close(),t.infoWindow=new google.maps.InfoWindow({content:'\n      <div class="info-window">\n        <img src='+n.image+">\n        <p>"+n.name+"</p>\n      </div>\n      "}),t.infoWindow.open(t.map,o)})},App.register=function(n){n.preventDefault(),this.$main.html('\n  <h2>Register</h2>\n  <form method="post" action="/register">\n    <div class="form-group">\n      <input class="form-control" type="text" name="user[username]" placeholder="Username">\n    </div>\n    <div class="form-group">\n      <input class="form-control" type="email" name="user[email]" placeholder="Email">\n    </div>\n    <div class="form-group">\n      <input class="form-control" type="password" name="user[password]" placeholder="Password">\n    </div>\n    <div class="form-group">\n      <input class="form-control" type="password" name="user[passwordConfirmation]" placeholder="Password Confirmation">\n    </div>\n    <input class="btn btn-primary" type="submit" value="Register">\n  </form>\n  ')},App.login=function(n){n.preventDefault(),this.$main.html('\n    <h2>Login</h2>\n    <form method="post" action="/login">\n      <div class="form-group">\n        <input class="form-control" type="email" name="email" placeholder="Email">\n      </div>\n      <div class="form-group">\n        <input class="form-control" type="password" name="password" placeholder="Password">\n      </div>\n      <input class="btn btn-primary" type="submit" value="Login">\n    </form>\n  ')},App.handleForm=function(n){n.preventDefault();var o=""+App.apiUrl+$(this).attr("action"),t=$(this).attr("method"),a=$(this).serialize();$.ajax({url:o,method:t,data:a}).done(function(n){n.token&&App.mapSetup()}).fail(function(n){console.log(n)})},App.init=function(){this.apiUrl="http://localhost:3000/api",this.$main=$("main"),$(".register").on("click",this.register.bind(this)),$(".login").on("click",this.login.bind(this)),this.$main.on("submit","form",this.handleForm),this.mapSetup()},$(App.init.bind(App));